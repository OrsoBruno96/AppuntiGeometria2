% trascrizione: Petrillo

Adesso facciamo un teorema che intuitivamente vuol dire:
preso un diffeomorfismo di $\R^n$ in sé stesso che preserva l'orientazione,
possiamo deformarlo in modo liscio (``senza strappi'')
fino a farlo diventare l'identità.
Ma prima, un lemma utilissimo:

\begin{lemma}[Taylor dei geometri]
	\label{th:lemprec}
	Sia $\fundef{U\subseteq\R^n}\R^k$ liscia con $U$ aperto convesso, $0\in U$, $f(0)=0$.
	Allora esistono $n$ funzioni lisce $\fundef[g_i]{\R^n}\R^k$ tali che $f(x)=\sum_ix_ig_i(x)$.
\end{lemma}

\begin{proof}
	Lavorando componente per componente, ci restringiamo al caso $k=1$.
	Per il teorema fondamentale del calcolo abbiamo:
	\[f(x)=
	f(1\cdot x)-f(0)=
	\int_0^1\deriv{}t\big(f(tx)\big)\de t=
	\sum_{i=1}^n\left(\int_0^1\pderiv f{x_i}(tx)\de t\right)x_i\]
	Allora poniamo:
	\[g_i(x)\is\int_0^1\pderiv f{x_i}(tx)\de t
	\qedhere\]
\end{proof}

\begin{teo}[Linearizzazione dei diffeomorfismi di $\R^n$ a meno di isotopia]
	\label{th:ldmi}
	Gli autodiffeomorfismi euclidei che preservano l'orientazione sono diff-isotopi all'identità:
	\begin{equation*}
		\begin{rcases}
			\fundef{\R^n}{\R^n}\text{ diffeomorfismo} \\
			\forall x\in\R^n:\det(\de_xf)>0
		\end{rcases}
		\implies \exists F:
		\begin{cases}
			\fundef[F]{\R^n\times[0;1]}{[0;1]}\text{ liscia} \\
			\forall t\in[0;1]:F_t\text{ diffeomorfismo} \\
			\hspace{-1ex}\begin{array}{l}
				F_0=f \\
				F_1=\id
			\end{array}\quad\text{dove }F_t\is F|_{\R^n\times\set t}
		\end{cases}
	\end{equation*}
\end{teo}

\begin{proof}
	Non costruiamo subito la $F$:
	esibiremo vari cammini del tipo di $F$ ma che non collegano direttamente $f$ a $\id$;
	la loro concatenazione darà $F$.
	
	\newcommand*\ISOMOUSE[2]{\fbox{${#1}\dashrightarrow{#2}$}}
	\begin{description}
		\item[\ISOMOUSE{f}{f(0)=0}]
			Sia $x_0\is f(0)$.
			Allora $H(x,t)\is f(x)-tx_0$ collega $f=H_0$ a $f'\is H_1$ con $f'(0)=0$,
			e $H_t$ è sempre un diffeomorfismo.
			Per leggerezza di notazione diciamo che $f(0)=0$.
		\item[\ISOMOUSE{f}{\de_0f}]
			Per definizione, $\de_0f(x)=\lim_{t\to 0}\frac{f(tx)}t$.
			Allora poniamo:
			\[\tilde F(x,t)\is
			\begin{dcases}
				\frac{f(tx)}t & t\in[0;1] \\
				\de_0f(x) & t=0
			\end{dcases}\]
			Verifichiamo che $\tilde F$ è liscia.
			Applicando il \autoref{th:lemprec} a $f$ abbiamo $\tilde F(x,t)=\sum_ix_ig_i(tx)$ per $t\neq 0$.
			Ma, osservando la forma esplicita delle $g_i$,
			vediamo che $g_i(0)=\pderiv f{x_i}(0)$,
			quindi l'uguaglianza si estende a $t=0$.
		\item[\ISOMOUSE{\de_0f}{B_1\in\SO_n}]
			Sia $A$ la matrice di $\de_0f$,
			per ipotesi $\det A>0$.
			Allora esiste un unico prodotto scalare definito positivo $\scp{}{}_A$
			tale che le colonne $A^i$ sono una base ortonormale;
			sia invece $\scp{}{}_I$ quello canonico.
			Osserviamo che
			\[\scp{}{}_t\is (1-t)\scp{}{}_A+t\scp{}{}_I\qquad t\in[0;1]\]
			ci dà un cammino di prodotti scalari definiti positivi.
			Per ogni $\scp{}{}_t$ applico Gram-Schmidt alle $A^i$ ottenendo una base ortonormale
			$\set{B_t^1,\dots,B_t^n}$
			dove consideriamo le $B^i_t$ come colonne di una matrice $B_t$.
			Basta dunque osservare che:
			\begin{itemize}
				\item le formule di Gram-Schmidt per le $B^i_t$ sono lisce;
				\item $\det B_t>0$;
				\item $B_0=A$;
				\item $B_1\in\SO_n$.
			\end{itemize}
		\item[\ISOMOUSE{B_1}{\id}]
			\marginpar{Non sono riuscito a formalizzare per bene il procedimento,
			che in effetti è geometricamente intuitivo:
			ruoto lungo un asse alla volta.
			Benedetti ha datto due hint:\\
			\emph{A lezione}: considero che le colonne $B_1^i$ sono una base ortonormale
			rispetto al prodotto canonico, ruoto e cambio base;\\
			\emph{Sulle dispense}: induzione su $n$ partendo da $\SO_2$.}
			È geometricamente intuitivo collegare una matrice di $\SO_n$ all'identità.
	\end{description}
	
	Per concatenare questi cammini in modo liscio,
	basta prima comporre la variabile $t$ con una funzione liscia $\fundef[\varphi]\R\R$ tale che:
	\[\varphi(0)=0, \quad
	\varphi(1)=1, \quad
	\forall k\ge1:\deriv[k]\varphi t(0)=\deriv[k]\varphi t(1)=0.\]
	Un esempio di tale funzione è:
	\[\varphi(x)=\frac{\phi_{0,2}(x)}{\phi_{0,2}(x)+\phi_{-1,1}(x)},\quad
	\phi_{a,b}(x)=\begin{cases}
		e^{\frac1{(x-a)(x-b)}} & x\in(a;b) \\
		0 & \text{altrimenti}
	\end{cases}\]
\end{proof}

Sia ora $\fundef{U\subseteq\R^n}{\R}$ liscia con $U$ aperto, $0\in U$, $f(0)=0$.
Espandiamo in serie la $f$:
\[f(x)=
\de_0f(x)+\transp{x}(H_0f)x+R
\quad\text{con}\quad
\lim_{x\to0}\frac R{\norm{x}^2}=0\]
Dove $Hf$ è la matrice hessiana, che per le funzioni lisce è simmetrica:
\[(H_0f)_{ij}\is
\frac{\partial^2f}{\partial x_j\partial x_i}(0)=(H_0f)_{ji}\]
Se $\de_0f\neq0$, siamo nelle ipotesi del teorema della funzione implicita, versione surgettiva.
Allora esiste una parametrizzazione locale $\psi$ tale che $f\circ\psi(x)=x_1$.

Supponiamo invece che $\de_0f=0$. In questo caso $f(x)=\transp{x}(H_0f)x+R$.
\begin{defn}[Punto critico]
	Sia $\fundef{U\subseteq\R^n}{\R}$ liscia; $x\in U$ si dice \emph{punto critico} di $f$ se $\de_xf=0$; un punto critico si dice \emph{non degenere} se $H_xf$ è invertibile.
\end{defn}

Supponiamo dunque che 0 sia un punto critico non degenere, cioè $\det(H_0f)\neq0$. Allora applichiamo il teorema di Sylvester alla matrice $H_0f$ (che è simmetrica e non singolare), avremo indici di positività e negatività $i_+$ e $i_-=n-i_+$ tali che:
\[\exists P\in\GL_n:
\transp P(H_0f)P=
\begin{pmatrix}
	\begin{matrix}
		1 & & \\
		& \ddots & \\
		& & 1 \\
	\end{matrix} & \Bigg\}i_+ \\
	i_-\Bigg\{ & \begin{matrix}
		-1 & & \\
		& \ddots & \\
		& & -1 \\
	\end{matrix}
\end{pmatrix}\si J\]

\begin{defn}[Indice del punto critico]
	Sia $x$ punto critico non degenere di $f$;
	chiamiamo \emph{indice di $x$} l'indice di negatività di $H_xf$.
\end{defn}

Sia $Q_A(x)\is\transp xAx$ la forma quadratica associata a una matrice $A$, allora:
\begin{align*}
Q_H(x)&=\transp{x}(H_0f)x \\
Q_J(x)&=x_1^2+\dots+x_{i_+}^2-(x_{1+i_+}^2+\dots+x_n^2) \\
f(x)&=Q_H(x)+R
\end{align*}

\begin{ex}
	Sia $\psi$ una parametrizzazione locale di $U$ intorno a 0.
	Allora $f\circ\psi$ ha un punto critico in $\psi^{-1}(0)$ con lo stesso indice.
\end{ex}

\begin{teo}[Lemma di Morse]
	\label{th:lemmamorse}
	Sia $f$ come sopra, allora esiste una parametrizzazione locale intorno all'origine che trasforma la $f$ nella forma quadratica canonica del tipo di $Q_J$:
	\[\begin{rcases}
		\fundef U\R\text{ liscia} \\
		\text{$U\subseteq\R^n$ intorno di $0$} \\
		\text{$0$ punto critico di indice $\lambda$} \\
		f(0)=0
	\end{rcases}\implies
	\exists\psi,W,U':\begin{dcases}
		W\subseteq\R^n\text{ intorno aperto di $0$} \\
		U'\subseteq U\text{ intorno aperto di $0$} \\
		\fundef[\psi]W{U'}\text{ diffeomorfismo} \\
		f\circ\psi(x)=-\sum_{i=1}^\lambda x_i^2+\sum_{i=\lambda+1}^nx_i^2
	\end{dcases}\]
\end{teo}

\begin{proof}
	Possiamo restringerci a $U$ convesso, e applicare due volte il \autoref{th:lemprec}:
	\begin{align*}
		f(0)=0 &\so f(x)=\sum_ix_ig_i(x) \\
		\de_0f\equiv0 &\so f(x)=\sum_{ij}b_{ij}(x)x_ix_j
	\end{align*}
	Dove le $b_{ij}$ sono lisce. Sia $B$ la matrice di componenti $b_{ij}$, poiché la usiamo in una forma quadratica è \wlg simmetrica (in effetti dalla formula esplicita si vedrebbe che è già simmetrica).
	Essendo $\GL_n$ aperto, a meno di restringere ancora $U$ le $B(x)$ sono invertibili e hanno lo stesso indice di negatività di $B(0)=H_0f$.
	
	Applichiamo Gram-Schmidt alle $B$:
	\[\forall x\in U\,\exists P(x)\in\GL_n:
	\transp PBP=
	\begin{pmatrix}
		\begin{matrix}
			-1 & & \\
			& \ddots & \\
			& & -1 \\
		\end{matrix} & \Bigg\}\lambda \\
		n-\lambda\Bigg\{ & \begin{matrix}
			1 & & \\
			& \ddots & \\
			& & 1 \\
		\end{matrix}
	\end{pmatrix}\si J\]
	Le formule di Gram-Schmidt sono lisce, quindi anche le $P(x)$.
	
	Sia $\fundef[\varphi]U{\R^n}$ con $\varphi(x)\is P(x)^{-1}x$.
	Osserviamo che $\de_0\varphi$ è invertibile, allora applichiamo il teorema della funzione inversa: intorno a 0, $\varphi$ è un diffeomorfismo (restringendo il codominio).
	Abbiamo finalmente $f=\transp\varphi(\transp PBP)\varphi=\transp\varphi J\varphi$.
\end{proof}
